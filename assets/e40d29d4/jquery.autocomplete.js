!function(e){e.fn.extend({legacyautocomplete:function(t,a){var n="string"==typeof t;return(a=e.extend({},e.Autocompleter.defaults,{url:n?t:null,data:n?null:t,delay:n?e.Autocompleter.defaults.delay:10,max:a&&!a.scroll?10:150},a)).highlight=a.highlight||function(e){return e},a.formatMatch=a.formatMatch||a.formatItem,this.each((function(){new e.Autocompleter(this,a)}))},result:function(e){return this.bind("result",e)},search:function(e){return this.trigger("search",[e])},flushCache:function(){return this.trigger("flushCache")},setOptions:function(e){return this.trigger("setOptions",[e])},unautocomplete:function(){return this.trigger("unautocomplete")}}),e.Autocompleter=function(t,a){var n,i,r,l=38,o=40,s=46,u=9,c=13,f=27,h=188,d=33,m=34,p=8,g=e(t).attr("autocomplete","off").addClass(a.inputClass),v="",C=e.Autocompleter.Cache(a),b=0,w={mouseDownOnSelect:!1},x=e.Autocompleter.Select(a,t,y,w);function y(){var n=x.selected();if(!n)return!1;var i=n.result;if(v=i,a.multiple){var r=L(g.val());if(r.length>1){var l,o=a.multipleSeparator.length,s=e(t).selection().start,u=0;e.each(r,(function(e,t){u+=t.length,s<=u&&(l=e),u+=o})),r[l]=i,i=r.join(a.multipleSeparator)}i+=a.multipleSeparator}return g.val(i),A(),g.trigger("result",[n.data,n.value]),!0}function S(e,t){if(i!=s){var n=g.val();(t||n!=v)&&(v=n,(n=T(n)).length>=a.minChars?(g.addClass(a.loadingClass),a.matchCase||(n=n.toLowerCase()),k(n,R,A)):(H(),x.hide()))}else x.hide()}function L(t){return t?a.multiple?e.map(t.split(a.multipleSeparator),(function(a){return e.trim(t).length?e.trim(a):null})):[e.trim(t)]:[""]}function T(n){if(!a.multiple)return n;var i=L(n);if(1==i.length)return i[0];var r=e(t).selection().start;return(i=r==n.length?L(n):L(n.replace(n.substring(r),"")))[i.length-1]}function A(){x.visible();x.hide(),clearTimeout(n),H(),a.mustMatch&&g.search((function(e){if(!e)if(a.multiple){var t=L(g.val()).slice(0,-1);g.val(t.join(a.multipleSeparator)+(t.length?a.multipleSeparator:""))}else g.val(""),g.trigger("result",null)}))}function R(n,r){r&&r.length&&b?(H(),x.display(r,n),function(n,r){a.autoFill&&T(g.val()).toLowerCase()==n.toLowerCase()&&i!=p&&(g.val(g.val()+r.substring(T(v).length)),e(t).selection(v.length,v.length+r.length))}(n,r[0].value),x.show()):A()}function k(n,i,r){a.matchCase||(n=n.toLowerCase());var l=C.load(n);if(l&&l.length)i(n,l);else if("string"==typeof a.url&&a.url.length>0){var o={timestamp:+new Date};e.each(a.extraParams,(function(e,t){o[e]="function"==typeof t?t():t})),e.ajax({mode:"abort",port:"autocomplete"+t.name,dataType:a.dataType,url:a.url,data:e.extend({q:T(n),limit:a.max},o),success:function(t){var r=a.parse&&a.parse(t)||function(t){for(var n=[],i=t.split("\n"),r=0;r<i.length;r++){var l=e.trim(i[r]);l&&(l=l.split("|"),n[n.length]={data:l,value:l[0],result:a.formatResult&&a.formatResult(l,l[0])||l[0]})}return n}(t);C.add(n,r),i(n,r)}})}else x.emptyList(),r(n)}function H(){g.removeClass(a.loadingClass)}null!==navigator.userAgent.match(/OPERA|OPR\//i)&&e(t.form).bind("submit.autocomplete",(function(){if(r)return r=!1,!1})),g.bind((null!==navigator.userAgent.match(/OPERA|OPR\//i)?"keypress":"keydown")+".autocomplete",(function(t){switch(b=1,i=t.keyCode,t.keyCode){case l:t.preventDefault(),x.visible()?x.prev():S(0,!0);break;case o:t.preventDefault(),x.visible()?x.next():S(0,!0);break;case d:t.preventDefault(),x.visible()?x.pageUp():S(0,!0);break;case m:t.preventDefault(),x.visible()?x.pageDown():S(0,!0);break;case a.multiple&&","==e.trim(a.multipleSeparator)&&h:case u:case c:if(y())return t.preventDefault(),r=!0,!1;break;case f:x.hide();break;default:clearTimeout(n),n=setTimeout(S,a.delay)}})).focus((function(){b++})).blur((function(){b=0,w.mouseDownOnSelect||(clearTimeout(n),n=setTimeout(A,200))})).click((function(){b++>1&&!x.visible()&&S(0,!0)})).bind("search",(function(){var t=arguments.length>1?arguments[1]:null;function a(e,a){var n;if(a&&a.length)for(var i=0;i<a.length;i++)if(a[i].result.toLowerCase()==e.toLowerCase()){n=a[i];break}"function"==typeof t?t(n):g.trigger("result",n&&[n.data,n.value])}e.each(L(g.val()),(function(e,t){k(t,a,a)}))})).bind("flushCache",(function(){C.flush()})).bind("setOptions",(function(){e.extend(a,arguments[1]),"data"in arguments[1]&&C.populate()})).bind("unautocomplete",(function(){x.unbind(),g.unbind(),e(t.form).unbind(".autocomplete")}))},e.Autocompleter.defaults={inputClass:"ac_input",resultsClass:"ac_results",loadingClass:"ac_loading",minChars:1,delay:400,matchCase:!1,matchSubset:!0,matchContains:!1,cacheLength:10,max:100,mustMatch:!1,extraParams:{},selectFirst:!0,formatItem:function(e){return e[0]},formatMatch:null,autoFill:!1,width:0,multiple:!1,multipleSeparator:", ",highlight:function(e,t){return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+t.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")},scroll:!0,scrollHeight:180},e.Autocompleter.Cache=function(t){var a={},n=0;function i(e,a){t.matchCase||(e=e.toLowerCase());var n=e.indexOf(a);return"word"==t.matchContains&&(n=e.toLowerCase().search("\\b"+a.toLowerCase())),-1!=n&&(0==n||t.matchContains)}function r(e,i){n>t.cacheLength&&o(),a[e]||n++,a[e]=i}function l(){if(!t.data)return!1;var a={},n=0;t.url||(t.cacheLength=1),a[""]=[];for(var i=0,l=t.data.length;i<l;i++){var o=t.data[i];o="string"==typeof o?[o]:o;var s=t.formatMatch(o,i+1,t.data.length);if(!1!==s){var u=s.charAt(0).toLowerCase();a[u]||(a[u]=[]);var c={value:s,data:o,result:t.formatResult&&t.formatResult(o)||s};a[u].push(c),n++<t.max&&a[""].push(c)}}e.each(a,(function(e,a){t.cacheLength++,r(e,a)}))}function o(){a={},n=0}return setTimeout(l,25),{flush:o,add:r,populate:l,load:function(r){if(!t.cacheLength||!n)return null;if(!t.url&&t.matchContains){var l=[];for(var o in a)if(o.length>0){var s=a[o];e.each(s,(function(e,t){i(t.value,r)&&l.push(t)}))}return l}if(a[r])return a[r];if(t.matchSubset)for(var u=r.length-1;u>=t.minChars;u--){if(s=a[r.substr(0,u)]){l=[];return e.each(s,(function(e,t){i(t.value,r)&&(l[l.length]=t)})),l}}return null}}},e.Autocompleter.Select=function(t,a,n,i){var r,l,o,s,u="ac_over",c=-1,f="",h=!0;function d(e){for(var t=e.target;t&&"LI"!=t.tagName;)t=t.parentNode;return t||[]}function m(e){r.slice(c,c+1).removeClass(u),function(e){c+=e,c<0?c=r.size()-1:c>=r.size()&&(c=0)}(e);var a=r.slice(c,c+1).addClass(u);if(t.scroll){var n=0;r.slice(0,c).each((function(){n+=this.offsetHeight})),n+a[0].offsetHeight-s.scrollTop()>s[0].clientHeight?s.scrollTop(n+a[0].offsetHeight-s.innerHeight()):n<s.scrollTop()&&s.scrollTop(n)}}function p(){s.empty();for(var a,n=(a=l.length,t.max&&t.max<a?t.max:a),i=0;i<n;i++)if(l[i]){var o=t.formatItem(l[i].data,i+1,n,l[i].value,f);if(!1!==o){var h=e("<li/>").html(t.highlight(o,f)).addClass(i%2==0?"ac_even":"ac_odd").appendTo(s)[0];e.data(h,"ac_data",l[i])}}r=s.find("li"),t.selectFirst&&(r.slice(0,1).addClass(u),c=0),e.fn.bgiframe&&s.bgiframe()}return{display:function(r,m){h&&(o=e("<div/>").hide().addClass(t.resultsClass).css("position","absolute").appendTo(document.body),s=e("<ul/>").appendTo(o).mouseover((function(t){d(t).nodeName&&"LI"==d(t).nodeName.toUpperCase()&&(c=e("li",s).removeClass(u).index(d(t)),e(d(t)).addClass(u))})).click((function(t){return e(d(t)).addClass(u),n(),a.focus(),!1})).mousedown((function(){i.mouseDownOnSelect=!0})).mouseup((function(){i.mouseDownOnSelect=!1})),t.width>0&&o.css("width",t.width),h=!1),l=r,f=m,p()},next:function(){m(1)},prev:function(){m(-1)},pageUp:function(){m(0!=c&&c-8<0?-c:-8)},pageDown:function(){c!=r.size()-1&&c+8>r.size()?m(r.size()-1-c):m(8)},hide:function(){o&&o.hide(),r&&r.removeClass(u),c=-1},visible:function(){return o&&o.is(":visible")},current:function(){return this.visible()&&(r.filter("."+u)[0]||t.selectFirst&&r[0])},show:function(){var n=e(a).offset();if(o.css({width:"string"==typeof t.width||t.width>0?t.width:e(a).width(),top:n.top+a.offsetHeight,left:n.left}).show(),t.scroll&&(s.scrollTop(0),s.css({maxHeight:t.scrollHeight,overflow:"auto"}),null!==navigator.userAgent.match(/MSIE/i)&&void 0===document.body.style.maxHeight)){var i=0;r.each((function(){i+=this.offsetHeight}));var l=i>t.scrollHeight;s.css("height",l?t.scrollHeight:i),l||r.width(s.width()-parseInt(r.css("padding-left"))-parseInt(r.css("padding-right")))}},selected:function(){var t=r&&r.filter("."+u).removeClass(u);return t&&t.length&&e.data(t[0],"ac_data")},emptyList:function(){s&&s.empty()},unbind:function(){o&&o.remove()}}},e.fn.selection=function(e,t){if(void 0!==e)return this.each((function(){if(this.createTextRange){var a=this.createTextRange();void 0===t||e==t?(a.move("character",e),a.select()):(a.collapse(!0),a.moveStart("character",e),a.moveEnd("character",t),a.select())}else this.setSelectionRange?this.setSelectionRange(e,t):this.selectionStart&&(this.selectionStart=e,this.selectionEnd=t)}));var a=this[0];if(a.createTextRange){var n=document.selection.createRange(),i=a.value,r=n.text.length;n.text="<->";var l=a.value.indexOf("<->");return a.value=i,this.selection(l,l+r),{start:l,end:l+r}}return void 0!==a.selectionStart?{start:a.selectionStart,end:a.selectionEnd}:void 0}}(jQuery);